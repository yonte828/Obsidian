# ToWord - Obsidian Plugin

Export your Obsidian markdown files to Microsoft Word (docx) format with full text styling, syntax highlighting, and **complete mobile support**. Files are saved directly in your vault for easy access across all platforms including iOS and Android.

## üéâ Version 1.4.0 - Major Mobile Update!

This version includes a complete rewrite for mobile compatibility:

-  **True iOS Support**: Resolved Buffer API incompatibilities that prevented mobile usage 
-  **Enhanced Syntax Highlighting**: Professional VS Code Default Light color scheme
-  **Universal Compatibility**: Works seamlessly on iPhone, iPad, Android, and desktop
-  **Improved Code Processing**: Better HTML entity handling and nested formatting

## Features

-  **Full Markdown Support**: Converts headings, lists, tables, code blocks, blockquotes, and more
-  **Text Styling**: Preserves bold, italic, strikethrough, highlights, and inline code
-  **Obsidian Appearance Matching**: Automatically uses your Obsidian fonts and sizes
-  **Professional Code Formatting**: Syntax highlighting with VS Code Default Light colors
-  **Tables**: Exports markdown tables with proper formatting and alignment
-  **Images**: Supports both standard markdown and Obsidian-style embedded images
-  **Hyperlinks**: Clickable links with proper styling
-  **Page Sizes**: Choose from A4, A5, A3, Letter, Legal, or Tabloid
-  **Vault Integration**: Saves files directly in your vault (not browser downloads)
-  **Flexible Output**: Choose where to save - same folder, vault root, or custom folder
-  **Configurable**: Settings panel to customize export behavior
-  **Mobile Optimized**: Full functionality on iOS, Android, and all desktop platforms
-  **Multiple Export Options**: 
  - Ribbon icon for quick export
  - Command palette integration
  - Right-click context menu on files

## Installation

### Manual Installation

1. Download the latest release from the releases page
2. Extract the files to your vault's plugins folder: `<vault>/.obsidian/plugins/to-word/`
3. Reload Obsidian
4. Enable the plugin in Settings ‚Üí Community Plugins

### Development Installation

1. Clone this repository into your vault's plugins folder
2. Run `npm install` to install dependencies
3. Run `npm run dev` to start compilation in watch mode
4. Reload Obsidian
5. Enable the plugin in Settings ‚Üí Community Plugins

## Usage

### Export Current File

1. **Using Ribbon Icon**: Click the document icon in the left ribbon
2. **Using Command Palette**: Press `Ctrl/Cmd + P` and search for "Export current file to Word"
3. **Using Context Menu**: Right-click on a markdown file and select "Export to Word"

The exported Word document will be saved in your vault according to your output location settings.

## Settings

Access plugin settings via Settings ‚Üí ToWord:

- **Default Font Family**: Set the default font for exported documents (default: Calibri)
- **Default Font Size**: Set the default font size in points (default: 11)
- **Include Metadata**: Choose whether to include frontmatter metadata in exports
- **Preserve Formatting**: Toggle markdown formatting preservation (bold, italic, etc.)
- **Use Obsidian Appearance**: **Automatically match your Obsidian theme's appearance**
  - When enabled: Reads your actual Obsidian settings including:
    - Text font family from your theme
    - Monospace font for code blocks (with fallback to Courier New)
    - Base font size (e.g., 16pt if that's your setting)
    - Heading sizes that scale proportionally with your text size
    - Line height and spacing
  - When disabled: Uses standard Word document sizes with your custom settings
  - **Smart detection**: Adapts to theme changes and font size adjustments
- **Include Filename as Header**: Add the filename as an H1 heading at the top of the document
- **Page Size**: Choose document page size (default: A4)
  - A4 (210 √ó 297 mm)
  - A5 (148 √ó 210 mm)
  - A3 (297 √ó 420 mm)
  - Letter (8.5 √ó 11 inches)
  - Legal (8.5 √ó 14 inches)
  - Tabloid (11 √ó 17 inches)
- **Output Location**: Choose where to save exported files:
  - **Same folder as markdown file**: Keeps exports next to source files
  - **Vault root**: Saves all exports to the vault root directory
  - **Custom folder**: Saves to a specified folder within your vault
- **Custom Output Folder**: Specify the folder path when using custom folder option (e.g., "Exports" or "Documents/Word")

## Supported Markdown Features

### Text Formatting

- ‚úÖ **Bold** (`**text**`)
- ‚úÖ *Italic* (`*text*`)
- ‚úÖ ***Bold Italic*** (`***text***`)
- ‚úÖ ~~Strikethrough~~ (`~~text~~`)
- ‚úÖ ==Highlight== (`==text==`)
- ‚úÖ `Inline code` (`` `code` ``) - Bold Courier New with background
- ‚úÖ Underline (via HTML `<u>`)
- ‚úÖ Superscript and Subscript (via HTML `<sup>`, `<sub>`)

### Structure

- ‚úÖ Headings (H1-H6) with proper styling
- ‚úÖ Paragraphs with line spacing
- ‚úÖ Horizontal rules (`---`, `***`, `___`)
- ‚úÖ Line breaks (two trailing spaces)
- ‚úÖ Blockquotes (with nesting support)

### Lists

- ‚úÖ Ordered lists (numbered)
- ‚úÖ Unordered lists (bullets)
- ‚úÖ Nested lists (up to 3 levels)
- ‚úÖ Task lists (`- [ ]` and `- [x]`) - rendered as ‚òê and ‚òë

### Code

- ‚úÖ Inline code with monospace font and background
- ‚úÖ Fenced code blocks with language support
- ‚úÖ **Professional syntax highlighting** with VS Code Default Light color scheme
- ‚úÖ Courier New Bold font for all code
- ‚úÖ Proper HTML entity handling for special characters

### Tables

- ‚úÖ Standard markdown tables
- ‚úÖ Column alignment (left, center, right)
- ‚úÖ Header row styling
- ‚úÖ Fixed column widths

### Links & References

- ‚úÖ Inline links (`[text](url)`)
- ‚úÖ Titled links (`[text](url "title")`)
- ‚úÖ Clickable hyperlinks in Word
- ‚úÖ Footnotes (`[^1]`) with superscript references

### Images

- ‚úÖ Standard markdown images (`![alt](url)`)
- ‚úÖ Obsidian embedded images (`![[image.png]]`)
- ‚úÖ **Resizer Plugin Integration**: Automatically respects custom image sizes
  - `![[image.png|447]]` - Width specification (maintains aspect ratio)
  - `![[image.png|447x300]]` - Exact width and height
  - `![alt](url|447)` - Standard markdown with size
- ‚úÖ Image formats: PNG, JPEG, GIF, SVG
- ‚úÖ Remote images (http/https URLs)
- ‚úÖ Local vault images
- ‚úÖ Auto-sizing: Large images (>600px) are automatically scaled to fit

### Limitations

- ‚ùå PDF embeds are skipped (Word cannot embed PDF files)
- ‚ö†Ô∏è Task list checkboxes are static (not interactive in Word)
- ‚ö†Ô∏è Collapsible sections are always expanded (Word doesn't support interactive collapse)

## Platform Support

- ‚úÖ **Windows**: Fully supported - saves to vault
- ‚úÖ **macOS**: Fully supported - saves to vault  
- ‚úÖ **Linux**: Fully supported - saves to vault
- ‚úÖ **iOS/iPadOS**: **Fully supported** - Native compatibility with fflate library
- ‚úÖ **Android**: **Fully supported** - Native compatibility with fflate library

**NEW in v1.4.0**: Complete mobile compatibility rewrite! Previous versions had Buffer API issues on iOS - now resolved with native JavaScript implementation. All platforms save the exported Word document directly to your vault according to your output location settings. No browser downloads!

## Development

### Building

```bash
# Install dependencies
npm install

# Development mode (watch)
npm run dev

# Production build
npm run build
```

### Project Structure

- `main.ts` - Main plugin file with Obsidian integration
- `converter.ts` - Markdown to DOCX conversion logic
- `manifest.json` - Plugin manifest
- `esbuild.config.mjs` - Build configuration

## Technologies Used

- [Obsidian API](https://github.com/obsidianmd/obsidian-api)
- [fflate](https://github.com/101arrowz/fflate) - Fast, native JavaScript ZIP library (mobile-optimized)
- [highlight.js](https://highlightjs.org/) - Syntax highlighting with VS Code Default Light theme
- [esbuild](https://esbuild.github.io/) - Fast JavaScript bundler
- TypeScript

**v1.4.0 Update**: Replaced JSZip with fflate for true mobile compatibility and better performance.

## License

MIT

## Support

If you encounter any issues or have feature requests, please file them in the GitHub issues section.

## Credits

Created with ‚ù§Ô∏è for the Obsidian community.
