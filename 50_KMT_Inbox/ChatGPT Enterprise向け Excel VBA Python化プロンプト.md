---
aliases: [ChatGPT Enterprise Python化プロンプト, Excel VBA Python移行プロンプト, ChatGPT Enterprise活用KMT]
---

# ChatGPT Enterprise向け Excel/VBA Python化プロンプト

## 目的
Excelの数式とVBAで動いているレガシーな業務ツールを、ChatGPT Enterpriseの「Advanced Data Analysis（旧Code Interpreter）」機能を活用し、Pythonのみで動作する（Excelアプリケーションに依存しない）クラウドネイティブなスクリプトに完全移行するためのプロンプト。

## 【準備】ChatGPTに投げるもの
プロンプトを投げる前に、以下の2つを準備する。

1.  **対象のExcelファイル**（データが入った状態のもの。機密情報はダミーでも可だが、Enterpriseならそのままでも安全。）
2.  **VBAのコード全文**（ExcelのVBE画面からテキストとしてコピーし、メモ帳などに貼り付けたテキストファイル、またはプロンプトに直接ペースト）
    *   *※ChatGPTは`.xlsm`の中のマクロを直接読むのが苦手な場合があるため、コードはテキストで渡すのが確実。*

## 【指示書】コピペ用プロンプト

```markdown
# 役割
あなたは熟練したPythonエンジニアであり、業務システムのリファクタリングの専門家です。
現在、Excel(数式)とVBAで動いているレガシーな業務ツールを、Pythonのみで動作する（Excelアプリケーションに依存しない）クラウドネイティブなスクリプトに完全移行したいと考えています。

# 依頼内容
添付の「Excelファイル」と、後述する「VBAコード」の内容を解析し、以下の要件を満たすPythonコードを作成してください。

# 現状のシステムの動き
1. Excelシート上で、[例: A列とB列の値をもとにD列で掛け算] などの計算を行っている。
2. VBAを使って [例: 計算結果が閾値を超えているか] を判定している。
3. 条件に合致した場合、Outlookを起動してメールを送信している。

# 移行後の要件（Python版の仕様）
1. **脱Excel依存**: `openpyxl` や `pandas` ライブラリを使用し、Excelアプリを起動せずにデータの読み書き・計算を行うこと。Excelの数式ロジックはすべてPythonの計算式に置き換えること。
2. **計算ロジックの移植**: Excelシート内の数式が何をしているか解析し、Python上で再現すること。
3. **メール送信の安定化**: Outlookアプリの起動（win32com）は使用せず、標準ライブラリの `smtplib` または `email` パッケージを使用してSMTPサーバー経由で送信する実装にすること。（SMTP設定は仮置きでOK）
4. **保守性**: 設定値（閾値やメールアドレスなど）は、コードの中に埋め込まず、変数の冒頭や別ファイル（configなど）で管理しやすいようにすること。

# 手順
ステップバイステップで実行してください。

## Step 1: Excel数式の解析
添付したExcelファイルの [例: "計算シート" という名前のシート] のデータ構造を確認してください。
特に [例: F列、G列] に入っている計算式がどのようなロジックになっているか（何と何を計算しているか）を言語化して説明してください。

## Step 2: VBAロジックの解析
以下のVBAコードを読み、処理フロー（どのタイミングで判定し、何をしているか）を要約してください。

-----
(ここにVBAコードを貼り付ける)
-----

## Step 3: Pythonコードの実装
Step 1, 2 の解析結果をもとに、入力となるExcelファイル（またはCSV）を読み込み、計算処理を行い、条件に応じてメール送信を行うPythonスクリプト全体を出力してください。
```

## プロンプトのポイント
*   **「脱Excel依存」の明記**: `xlwings`や`win32com`を使った「PythonからExcelを操作する（結局Excelが必要）」コードを防ぐため、「Excelアプリを起動せずに」「pandasなどを使う」と技術指定している。
*   **数式とVBAの分離解析**: 「Excelのセル計算」と「VBAの制御」は役割が違うため、ステップを分けて解析させることで、計算ミスのない正確な移植を狙う。
*   **Outlook廃止の指定**: 不安定なOutlook操作（MAPI/COM連携）を禁止し、サーバー上で動かせるSMTP方式を指定している。

#KMT #ChatGPTEnterprise #Python #VBA移行 #業務効率化 #AdvancedDataAnalysis #プロンプトエンジニアリング #リファクタリング